---
title: Image Optimization
description: Optimize images with Contentstack's Image Delivery API and @nuxt/image integration for responsive, fast-loading images with advanced transformations.
navigation:
  icon: i-lucide-image
---

Nuxt Contentstack provides powerful image optimization through seamless integration with @nuxt/image and Contentstack's Image Delivery API, enabling responsive images, automatic format conversion, and advanced transformations.

## Overview

Image optimization features include:

- **@nuxt/image Integration**: Native Nuxt image optimization
- **Contentstack Provider**: Custom provider for Image Delivery API
- **Responsive Images**: Automatic sizing and density handling
- **Format Optimization**: WebP, AVIF conversion with fallbacks
- **Advanced Transformations**: Resize, crop, effects, and overlays
- **Lazy Loading**: Optimized loading strategies

## Setup

### 1. Install @nuxt/image

```bash
npm install @nuxt/image
```

### 2. Configure Modules

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  modules: [
    'nuxt-contentstack',
    '@nuxt/image'
  ],
  
  // Optional: Configure Contentstack image provider
  image: {
    providers: {
      contentstack: {
        name: "contentstack",
        provider: "node_modules/nuxt-contentstack/dist/runtime/providers/contentstack",
      },
    },
    provider: "contentstack", // Optional: set as default
  }
})
```

## Basic Usage

### NuxtImg Component

```vue [components/OptimizedImage.vue]
<template>
  <NuxtImg
    :src="image.url"
    :alt="image.title"
    width="800"
    height="400"
    provider="contentstack"
  />
</template>

<script setup>
defineProps<{
  image: {
    url: string
    title: string
  }
}>()
</script>
```

### NuxtPicture for Art Direction

```vue [components/ResponsiveImage.vue]
<template>
  <NuxtPicture
    :src="hero.image.url"
    :imgAttrs="{ alt: hero.image.title }"
    sizes="100vw md:50vw lg:33vw"
    densities="1x 2x"
    provider="contentstack"
  />
</template>
```

## Advanced Transformations

### Quality and Format Optimization

```vue [components/QualityOptimized.vue]
<template>
  <NuxtImg
    :src="image.url"
    :alt="image.title"
    width="600"
    height="400"
    :modifiers="{
      auto: 'webp,compress',
      quality: 85,
      format: 'webp'
    }"
    provider="contentstack"
  />
</template>
```

### Cropping and Fitting

```vue [components/CroppedImage.vue]
<template>
  <NuxtImg
    :src="gallery.image.url"
    width="300"
    height="300"
    :modifiers="{
      fit: 'crop',
      crop: 'center',
      quality: 90
    }"
    provider="contentstack"
  />
</template>
```

### Visual Effects

```vue [components/StylizedImage.vue]
<template>
  <NuxtImg
    :src="artistic.image.url"
    width="500"
    height="300"
    :modifiers="{
      blur: 2,
      brightness: 110,
      contrast: 120,
      saturation: 130,
      quality: 80
    }"
    provider="contentstack"
  />
</template>
```

## useImageTransform Composable

For programmatic image transformations and dynamic modifications:

### Basic Usage

```vue [components/DynamicImage.vue]
<script setup>
const props = defineProps<{
  imageUrl: string
  size: 'small' | 'medium' | 'large'
}>()

const sizeMap = {
  small: { width: 300, height: 200 },
  medium: { width: 600, height: 400 },
  large: { width: 1200, height: 800 }
}

const { transformedUrl } = useImageTransform(
  props.imageUrl,
  {
    ...sizeMap[props.size],
    quality: 85,
    format: 'webp',
    auto: 'compress'
  }
)
</script>

<template>
  <img 
    :src="transformedUrl" 
    :alt="alt"
    class="responsive-image"
  />
</template>
```

## Advanced Features

### Overlay Images

```typescript [composables/useWatermark.ts]
export const useWatermarkImage = (baseImageUrl: string, watermarkUrl: string) => {
  const { transformedUrl } = useImageTransform(baseImageUrl, {
    width: 800,
    height: 600,
    quality: 85,
    overlay: {
      relativeURL: watermarkUrl,
      align: 'bottom-right',
      width: '20p', // 20% of base image
      opacity: 80
    }
  })
  
  return { watermarkedUrl: transformedUrl }
}
```

### Smart Cropping

```vue [components/SmartCrop.vue]
<script setup>
const props = defineProps<{
  image: {
    url: string
    title: string
    focalPoint?: {
      x: number
      y: number
    }
  }
}>()

const { transformedUrl } = useImageTransform(props.image.url, {
  width: 400,
  height: 300,
  fit: 'crop',
  crop: props.image.focalPoint 
    ? `${props.image.focalPoint.x},${props.image.focalPoint.y}`
    : 'smart'
})
</script>

<template>
  <img 
    :src="transformedUrl" 
    :alt="image.title"
    class="smart-cropped"
  />
</template>
```

### Progressive Enhancement

Load a low-quality placeholder first, then swap to high-quality:

```vue [components/ProgressiveImage.vue]
<script setup>
const props = defineProps<{
  imageUrl: string
  alt: string
}>()

// Low quality placeholder
const { transformedUrl: placeholder } = useImageTransform(props.imageUrl, {
  width: 50,
  quality: 20,
  blur: 5
})

// High quality image
const { transformedUrl: highQuality } = useImageTransform(props.imageUrl, {
  width: 800,
  quality: 85,
  format: 'webp'
})

const isLoaded = ref(false)
</script>

<template>
  <div class="progressive-image">
    <img v-show="!isLoaded" :src="placeholder" :alt="alt" class="placeholder" />
    <img :src="highQuality" :alt="alt" @load="isLoaded = true" />
  </div>
</template>
```

## Responsive Images

Use `NuxtPicture` for responsive images with breakpoint-based sizing:

```vue [components/ResponsiveHero.vue]
<template>
  <NuxtPicture
    :src="hero.image.url"
    :imgAttrs="{ alt: hero.image.title }"
    :modifiers="{ quality: 85, auto: 'webp,compress' }"
    sizes="100vw sm:90vw md:80vw lg:1200px"
    densities="1x 2x"
    provider="contentstack"
  />
</template>
```

### Art Direction

```vue [components/ArtDirectedImage.vue]
<template>
  <picture>
    <!-- Desktop version (landscape) -->
    <source
      media="(min-width: 768px)"
      :srcset="desktopSrcset"
      type="image/webp"
    />
    
    <!-- Mobile version (portrait crop) -->
    <source
      :srcset="mobileSrcset"
      type="image/webp"
    />
    
    <!-- Fallback -->
    <img :src="fallbackSrc" :alt="image.title" />
  </picture>
</template>

<script setup>
const props = defineProps<{
  image: { url: string; title: string }
}>()

// Desktop landscape
const { transformedUrl: desktopSrcset } = useImageTransform(props.image.url, {
  width: 1200,
  height: 600,
  fit: 'crop',
  crop: 'center'
})

// Mobile portrait
const { transformedUrl: mobileSrcset } = useImageTransform(props.image.url, {
  width: 400,
  height: 600,
  fit: 'crop',
  crop: 'top'
})

// Fallback
const { transformedUrl: fallbackSrc } = useImageTransform(props.image.url, {
  width: 800,
  height: 400
})
</script>
```

## Performance Optimization

### Lazy Loading

```vue [components/LazyImage.vue]
<template>
  <NuxtImg
    :src="image.url"
    :alt="image.title"
    loading="lazy"
    width="600"
    height="400"
    :modifiers="{ quality: 80 }"
    provider="contentstack"
  />
</template>
```

### Preloading Critical Images

```vue [pages/index.vue]
<script setup>
// Preload hero image
const { data: page } = await useGetEntryByUrl({
  contentTypeUid: 'landing_page',
  url: '/'
})

if (page.value?.hero?.image) {
  const { transformedUrl } = useImageTransform(page.value.hero.image.url, {
    width: 1200,
    height: 600,
    quality: 85
  })
  
  // Preload the hero image
  useHead({
    link: [
      {
        rel: 'preload',
        href: transformedUrl,
        as: 'image'
      }
    ]
  })
}
</script>
```

### Multiple Image Sizes

Generate multiple sizes for galleries and lightboxes:

```vue [components/OptimizedGallery.vue]
<script setup>
const props = defineProps<{
  images: Array<{ url: string; title: string }>
}>()

const optimizedImages = computed(() => {
  return props.images.map(image => ({
    ...image,
    thumbnail: useImageTransform(image.url, { width: 300, height: 200, quality: 75 }).transformedUrl,
    medium: useImageTransform(image.url, { width: 800, height: 600, quality: 85 }).transformedUrl,
    large: useImageTransform(image.url, { width: 1600, height: 1200, quality: 90 }).transformedUrl
  }))
})
</script>

<template>
  <div class="gallery">
    <img 
      v-for="image in optimizedImages" 
      :key="image.url"
      :src="image.thumbnail"
      :alt="image.title"
      loading="lazy"
    />
  </div>
</template>
```

## Error Handling

Handle image loading errors and states:

```vue [components/SafeImage.vue]
<script setup>
const props = defineProps<{
  src: string
  alt: string
  fallback?: string
}>()

const imageSrc = ref(props.src)
const hasError = ref(false)

const handleError = () => {
  if (!hasError.value && props.fallback) {
    hasError.value = true
    imageSrc.value = props.fallback
  }
}
</script>

<template>
  <div v-if="hasError && !fallback" class="error-state">
    Failed to load image
  </div>
  <img v-else :src="imageSrc" :alt="alt" @error="handleError" />
</template>
```

## Available Transformations

### Dimension Control

| Parameter | Description | Example |
|-----------|-------------|---------|
| `width` | Set image width | `width: 800` |
| `height` | Set image height | `height: 600` |
| `dpr` | Device pixel ratio | `dpr: 2` |

### Quality and Format

| Parameter | Description | Example |
|-----------|-------------|---------|
| `quality` | JPEG quality (1-100) | `quality: 85` |
| `format` | Output format | `format: 'webp'` |
| `auto` | Auto optimization | `auto: 'webp,compress'` |

### Cropping and Fitting

| Parameter | Description | Example |
|-----------|-------------|---------|
| `fit` | Resize behavior | `fit: 'crop'` |
| `crop` | Crop position | `crop: 'center'` |
| `trim` | Remove edges | `trim: 5` |

### Effects

| Parameter | Description | Example |
|-----------|-------------|---------|
| `blur` | Blur amount (0-100) | `blur: 5` |
| `brightness` | Brightness (-100 to 100) | `brightness: 10` |
| `contrast` | Contrast (-100 to 100) | `contrast: 20` |
| `saturation` | Saturation (-100 to 100) | `saturation: 15` |

## Next Steps

::div{class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6"}
  ::card
  ---
  title: "Composables"
  icon: "i-lucide-code"
  to: "/essentials/composables"
  ---
  Learn how to fetch and use images with Contentstack composables.
  ::
::
